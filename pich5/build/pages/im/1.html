<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"/>
    <meta content="telephone=no" name="format-detection"/>
    <meta name="apple-touch-fullscreen" content="yes"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <title></title>
    <link rel="stylesheet" href="index.css">
</head>
<body style="position: absolute;top: 0px;height: 100%;width: 100%;bottom: 0px;">
<div id="loading">
    <div class="loading-content">loading...</div>
</div>
<div id="page" style="position: absolute;top: 0px;height: 100%;width: 100%;bottom: 0px;">
    <div id="test" style="height:100%;overflow: hidden;top: 0px;bottom: 0px;">
        <ul id="chatpanel">

        </ul>
    </div>
    <div id="footer">
        <div id="chatBottomBox">
            <div id="textBox">
                <input type="text" id="content" placeholder="Enter the chat"/>
            </div>
            <button id="btnSend">Kirim</button>
        </div>
    </div>
</div>
<script src="../../lib/libAll.js?version=0.1.5"></script>
<script src="../../lib/strophe.js?version=0.1.5"></script>
<script src="../../lib/easemob.im-1.0.7.js?version=0.1.5"></script>
<script src="../../lib/easemob.im.config.js?version=0.1.5"></script>

<script>
    (function () {
        var conn = null,
                appKey = "etang114-shuohua#shuohua";

        var loading = $("#loading");

        conn = new Easemob.im.Connection();


//       登录：


        conn.init({
            onOpened: function () {
                alert("登录成功");
                conn.setPresence();
            }

        });

        open(conn,'8296','bc05d9961476642c6aba1a88a939467c');

        setInterval(function(){
            sendText(conn,"8297","abc")
        },1000);


        function open(connect, user, pwd) {
            connect.open({
                user: "8296",
                pwd: "bc05d9961476642c6aba1a88a939467c",
                appKey: appKey

                /*
                 apiUrl : Easemob.im.config.apiURL,
                 user : user,
                 accessToken : token,
                 //连接时提供appkey
                 appKey : Easemob.im.config.appkey
                 */
            });
        }

        function sendText(connect, to, msg, type) {
            connect.sendTextMessage({
                to: to,
                msg: msg,
                type: type || "chat"
            })
        }

        function handleTextMsg(msg) {
            var from = msg.from, type = msg.type, content = msg.data;

            if (type == "groupchat") {

            } else {
                //单个消息
            }
        }


    })();
</script>
</body>
</html>