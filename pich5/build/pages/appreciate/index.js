/*! Generated by Clam: wechat 2016-05-01 19:22:47 */
!function(a,b){var c=function(){var a=this;Wlib.wx.checkLogin(function(){Wlib.wx.getJSSign("",function(b){Wlib.wx.jsConfig(b,function(){Wlib.wx.hideMenu(),a.init()})})})};c.prototype={init:function(){var a=this;a.addJuicerHandler(),a.cacheData(),a.cacheDom(),a.getData()},cacheData:function(){var a=this;a.data={id:Wlib.getRequestParam("id")},a.data.edite=Wlib.getRequestParam("edite")},cacheDom:function(){var a=this;a.dom={wrapper:b("#page"),loading:b("#loading"),tpl:b("#tpl")}},renderUI:function(){var a=this;if(a.dom.wrapper.html(juicer(a.dom.tpl.html(),a.data)),a.data.edite){var c={wrapper:b(".seller-wrapper"),proId:a.data.id,editeUrl:"../../pages/post/like.html?id="+a.data.id};new EditeProduct(c)}a.dom.loading.hide()},recacheDom:function(){var a=this;a.dom.moreLi=b("#more .swiper-slide"),a.dom.scrollTo=b(".icon10"),a.dom.myBtn=b("#mybtn"),a.dom.buyBtn=b(".buyBtn"),a.dom.sendComm=b(".backToHome"),a.dom.commText=b(".saysometing input"),a.dom.moreComm=b(".more-btn")},addJuicerHandler:function(){juicer.register("getId",function(a){return Wlib.getRequestParam("id",a)}),juicer.register("getType",function(a){var b="";switch(a){case"\u51fa\u552e":b="../../pages/sale/index.html";break;case"\u62cd\u5356":b="../../pages/auction/index.html"}return b}),juicer.register("makeHackInputDisplay",function(a){return a==localStorage.getItem("uid")?!1:!0})},shareWX:function(){var a=this;setTimeout(function(){var b={title:"\u5fae\u62cd\u65f6\u4ee3 \u5168\u6c11\u8bf4\u753b",desc:a.data.data.author+"\u4f5c\u54c1\u6b23\u8d4f",link:"http://wx.talkart.cn/pages/appreciate/index.html?id="+Wlib.getRequestParam("id"),img:a.data.data.minipic[0]};Wlib.wx.shareTo(b.title,b.desc,b.link,b.img)},200)},bindEvent:function(){var c=this;c.shareWX(),FastClick.attach(document.body);new Swiper("#pics",{pagination:".swiper-pagination"}),new Swiper("#more",{slidesPerView:3.5,paginationClickable:!0,spaceBetween:5,lazyLoading:!0});Wlib._scrollHide(100,c.dom.scrollTo),c.dom.moreLi.on("click",function(){var c=b(this).attr("data-id"),d=b(this).attr("data-url");return c?void(a.location=d+"?id="+c):void Wlib.tips("\u5df2\u7ecf\u4e0b\u67b6")}),c.dom.scrollTo.on("click",function(){b.scrollTo(0,500)}),c.dom.myBtn.on("click",function(){a.location="../../pages/my/index.html"}),c.dom.buyBtn.on("click",function(){a.location="../../pages/buy/index.html"}),b("#pics .swiper-slide").on("click",function(){var a=b(this).find("img").attr("src");Wlib.wx.previewImgs(a,c.data.data.pic)}),b("#complain").on("click",function(){c.addComplain(this)}),b("#collect").on("click",function(){c.addCollect(this)}),c.dom.sendComm.on("click",function(){c.sendComm()}),c.dom.moreComm.on("click",function(){Wlib.tips("\u4e0b\u8f7dAPP\u67e5\u770b\u66f4\u591a\u8bc4\u8bba\u3002"),location.href="http://www.talkart.cc/index.php?r=default/index/download"}),b("#praise").on("click",function(){c.addPraise(this)}),b(".seller-wrapper").on("click",function(){location.href="../../pages/friendInfo/index.html?fid="+c.data.data.user_id}),b(".ul-wrapper4 li").on("click",function(){var a=this,d=0==b(this).find("input").length?!0:!1,e=b(this).attr("data-id"),f=b(this).attr("data-fromId"),g=b(this).attr("data-name");d?Wlib.confirm("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u8bc4\u8bba\u5417?",["\u53d6\u6d88"],["\u786e\u8ba4"],function(){c.deleCommon(e,function(){b(a).remove()})}):(c.dom.commText.attr("placeholder","\u56de\u590d"+g+":").focus(),c.FEEDBACKID=f,b.scrollTo(5e3,200))}),Wlib._bindLazyLoad()},deleCommon:function(a,b){var c=this,d={id:a,uid:localStorage.getItem("uid"),token:localStorage.getItem("token")};c.dom.loading.show(),Wlib.SendRequest("default/person/deleteComment",d,"GET",function(a){1==a.state?(c.dom.loading.hide(),Wlib.tips("\u5220\u9664\u8bc4\u8bba\u6210\u529f"),b&&b()):(c.dom.loading.hide(),Wlib.tips("\u5220\u9664\u8bc4\u8bba\u5931\u8d25"))})},getData:function(){var a=this,b={id:a.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token")};Wlib.SendRequest("default/api/info",b,"GET",function(b){a.data.data=b,a.renderUI(),a.recacheDom(),a.bindEvent()})},addPraise:function(a){var c=this,d={id:c.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1};c.dom.loading.show(),0==c.data.data.praise?Wlib.SendRequest("default/picture/praise",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).removeClass("icon7").addClass("icon9"),c.data.data.praise=1):(c.dom.loading.hide(),Wlib.tips("\u70b9\u8d5e\u5931\u8d25"))}):(d.type=2,Wlib.SendRequest("default/picture/praise",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).removeClass("icon9").addClass("icon7"),c.data.data.praise=0):(c.dom.loading.hide(),Wlib.tips("\u53d6\u6d88\u70b9\u8d5e\u5931\u8d25"))}))},addComplain:function(a){var b=this,c={id:b.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1};b.dom.loading.show(),Wlib.SendRequest("default/picture/complain",c,"POST",function(a){1==a.state?(b.dom.loading.hide(),Wlib.tips("\u4e3e\u62a5\u6210\u529f")):(b.dom.loading.hide(),Wlib.tips("\u4e3e\u62a5\u5931\u8d25"))})},addCollect:function(a){var c=this,d={id:c.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1};c.dom.loading.show(),0==c.data.data.collect?Wlib.SendRequest("default/picture/collect",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u5df2\u6536\u85cf"),c.data.data.collect=1):(c.dom.loading.hide(),Wlib.tips("\u6536\u85cf\u5931\u8d25"))}):Wlib.SendRequest("default/picture/collect",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u6536\u85cf"),c.data.data.collect=0):(c.dom.loading.hide(),Wlib.tips("\u53d6\u6d88\u6536\u85cf\u5931\u8d25"))})},sendComm:function(){var a=this,b={id:a.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1,content:a.dom.commText.val()};a.FEEDBACKID&&(b.fid=a.FEEDBACKID),a.dom.loading.show(),Wlib.SendRequest("default/picture/comment",b,"POST",function(b){1==b.state?(a.dom.loading.hide(),Wlib.tips("\u8bc4\u8bba\u6210\u529f"),setTimeout(function(){location.reload()},3e3)):(a.dom.loading.hide(),Wlib.tips("\u8bc4\u8bba\u5931\u8d25"))}),a.dom.commText.val("")}};new c}(window,$);