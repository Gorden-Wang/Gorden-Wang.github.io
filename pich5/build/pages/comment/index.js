/*! Generated by Clam: wechat 2016-05-09 16:25:30 */
!function(a,b){var c=function(){var a=this;Wlib.wx.getJSSign("",function(b){Wlib.wx.jsConfig(b,function(){Wlib.wx.hideMenu(),a.init()})})};c.prototype={init:function(){var a=this;a.addJuicerHandler(),a.cacheData(),a.cacheDom(),a.getData()},cacheData:function(){var a=this;a.data={id:Wlib.getRequestParam("id"),comm_id:Wlib.getRequestParam("comm_id")}},cacheDom:function(){var a=this;a.dom={wrapper:b("#page"),loading:b("#loading"),tpl:b("#tpl")}},renderUI:function(){var a=this;a.dom.wrapper.html(juicer(a.dom.tpl.html(),a.data)),a.dom.loading.hide()},recacheDom:function(){var a=this;a.dom.moreLi=b("#more .swiper-slide"),a.dom.scrollTo=b(".icon10"),a.dom.myBtn=b("#mybtn"),a.dom.buyBtn=b(".btn-w"),a.dom.pricede=b(".icon11"),a.dom.priceadd=b(".icon12"),a.dom.pricewrap=b("#pricetext"),a.dom.praiseList=b("#praise_list"),a.dom.sendComm=b(".backToHome"),a.dom.commText=b(".saysometing input"),a.dom.moreComm=b(".more-btn")},addJuicerHandler:function(){juicer.register("getId",function(a){return Wlib.getRequestParam("id",a)}),juicer.register("getType",function(a){var b="";switch(a){case"\u51fa\u552e":b="../../pages/sale/index.html";break;case"\u62cd\u5356":b="../../pages/auction/index.html"}return b})},bindEvent:function(){var c=this;Wlib._scrollHide(100,c.dom.scrollTo),c.dom.moreLi.on("click",function(){var c=b(this).attr("data-id"),d=b(this).attr("data-url");return c?void(a.location=d+"?id="+c):void Wlib.tips("\u5df2\u7ecf\u4e0b\u67b6")}),c.dom.scrollTo.on("click",function(){b.scrollTo(0,500)}),c.dom.myBtn.on("click",function(){a.location="../../pages/my/index.html"}),b(".follow-btn").on("click",function(){c.addAttention(this)}),b("#praise").on("click",function(){c.addPraise(this)}),c.dom.pricede.on("click",function(){var a=parseInt(c.data.data.starting_price),b=parseInt(c.dom.pricewrap.text()),d=b-parseInt(c.data.data.range);d>=a&&c.dom.pricewrap.text(d)}),c.dom.priceadd.on("click",function(){var a=parseInt(c.dom.pricewrap.text());c.dom.pricewrap.text(a+parseInt(c.data.data.range))}),b("#complain").on("click",function(){c.addComplain(this)}),b("#collect").on("click",function(){c.addCollect(this)}),c.dom.sendComm.on("click",function(){c.sendComm()}),b("#pics .swiper-slide").on("click",function(){var a=b(this).find("img").attr("src");Wlib.wx.previewImgs(a)}),Wlib._bindLazyLoad()},getData:function(){var a=this,b={id:a.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),comm_id:a.data.comm_id};Wlib.SendRequest("default/picture/delayDiscuss",b,"GET",function(b){a.data.data=b,a.renderUI(),a.recacheDom(),a.bindEvent()})},addAttention:function(a){var c=this,d={id:c.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token")};c.dom.loading.show(),0==c.data.data.focus?Wlib.SendRequest("default/picture/attention",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u53d6\u6d88\u5173\u6ce8"),c.data.data.focus=1):(c.dom.loading.hide(),Wlib.tips("\u5173\u6ce8\u5931\u8d25"))}):Wlib.SendRequest("default/picture/attentionDel",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u5173\u6ce8\u6b64\u4ef6"),c.data.data.focus=0):(c.dom.loading.hide(),Wlib.tips("\u53d6\u6d88\u5173\u6ce8\u5931\u8d25"))})},addPraise:function(a){var c=this,d={id:c.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1};c.dom.loading.show(),0==c.data.data.praise?Wlib.SendRequest("default/picture/praise",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).removeClass("icon7").addClass("icon9"),c.data.data.praise=1):(c.dom.loading.hide(),Wlib.tips("\u70b9\u8d5e\u5931\u8d25"))}):(d.type=2,Wlib.SendRequest("default/picture/praise",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).removeClass("icon9").addClass("icon7"),c.data.data.praise=0):(c.dom.loading.hide(),Wlib.tips("\u53d6\u6d88\u70b9\u8d5e\u5931\u8d25"))}))},addComplain:function(a){var b=this,c={id:b.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1};b.dom.loading.show(),Wlib.SendRequest("default/picture/complain",c,"POST",function(a){1==a.state?(b.dom.loading.hide(),Wlib.tips("\u4e3e\u62a5\u6210\u529f")):(b.dom.loading.hide(),Wlib.tips("\u4e3e\u62a5\u5931\u8d25"))})},addCollect:function(a){var c=this,d={id:c.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1};c.dom.loading.show(),0==c.data.data.collect?Wlib.SendRequest("default/picture/collect",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u53d6\u6d88\u6536\u85cf"),c.data.data.collect=1):(c.dom.loading.hide(),Wlib.tips("\u6536\u85cf\u5931\u8d25"))}):Wlib.SendRequest("default/picture/collect",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u6536\u85cf"),c.data.data.collect=0):(c.dom.loading.hide(),Wlib.tips("\u53d6\u6d88\u6536\u85cf\u5931\u8d25"))})},addAttention:function(a){var c=this,d={id:c.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token")};c.dom.loading.show(),0==c.data.data.focus?Wlib.SendRequest("default/picture/collect",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u53d6\u6d88\u5173\u6ce8"),c.data.data.focus=1):(c.dom.loading.hide(),Wlib.tips("\u5173\u6ce8\u5931\u8d25"))}):Wlib.SendRequest("default/picture/collect",d,"GET",function(d){1==d.state?(c.dom.loading.hide(),Wlib.tips(d.message),b(a).html("\u5173\u6ce8\u6b64\u4ef6"),c.data.data.focus=0):(c.dom.loading.hide(),Wlib.tips("\u53d6\u6d88\u5173\u6ce8\u5931\u8d25"))})},sendComm:function(){var a=this,b={id:a.data.id,uid:localStorage.getItem("uid"),token:localStorage.getItem("token"),type:1,content:a.dom.commText.val()};a.dom.loading.show(),Wlib.SendRequest("default/picture/comment",b,"POST",function(b){1==b.state?(a.dom.loading.hide(),Wlib.tips("\u8bc4\u8bba\u6210\u529f"),setTimeout(function(){location.reload()},3e3)):(a.dom.loading.hide(),Wlib.tips("\u8bc4\u8bba\u5931\u8d25"))})}};new c}(window,$);