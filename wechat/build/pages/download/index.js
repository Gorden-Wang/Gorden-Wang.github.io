/*! Generated by Clam: wechat 2015-12-29 21:06:53 */
!function(a,b){var c=function(){this.init()};c.prototype={init:function(){var a=this;a.addJuicerHandler(),a.router(),a.cacheData(),a.cacheDom(),a.initWeChat()},cacheDom:function(){var a=this;a.dom={wrapper:b("#page"),loading:b("#loading"),tpl:b("#tpl")}},cacheData:function(){var a=this;a.data={}},renderUI:function(){var a=this;a.dom.wrapper.html(juicer(a.dom.tpl.html(),a.data)),a.dom.loading.hide()},initWeChat:function(){wx.ready(function(){wx.onMenuShareAppMessage({title:b("#shareTitle").attr("content"),desc:b("#shareDes").attr("content"),link:b("#shareLink").attr("content")||window.location.href,imgUrl:b("#shareImg").attr("content")||"http://www.gorden.wang/wechat/build/pages/download/logo.png",type:"link",dataUrl:"",success:function(){},cancel:function(){}})})},recacheDom:function(){var a=this;a.dom.banner=b(".banner"),a.dom.full=b(".full-img")},addJuicerHandler:function(){juicer.register("makeRate",function(a){var b=new Rate({rate:parseFloat(a),activeImg:"./redstar.png",defaultImg:"./graystar.png",halfImg:"./halfstar.png"});return b.init()}),juicer.register("makeTime",function(a,b){var c=new Date(a),d={y:c.getFullYear(),m:c.getMonth()+1<10?"0"+(c.getMonth()+1):c.getMonth()+1,d:c.getDate(),h:c.getHours(),mm:c.getMinutes()+1};return b?d.m+"/"+d.d+" "+d.h+":"+d.mm:d.y+"/"+d.m+"/"+d.d}),juicer.register("makeFuckTime",function(a){return a.replace(/([^-])+-/,"").slice(0,-3)})},bindEvent:function(){function a(){var a=b(this).scrollTop();Math.abs(e-a)<=f||(a>e&&a>g?b("header").removeClass("nav-down").addClass("nav-up"):a+b(window).height()<b(document).height()&&b("header").removeClass("nav-up").addClass("nav-down"),e=a)}{var c=this;navigator.userAgent.match(/iPhone|iPad|iPod/)?!0:!1}b("#download").on("click",function(){window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.yihealth"}),b("footer").on("click",function(){window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.yihealth"}),b(".download-li").on("click",function(){window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.yihealth"});var d,e=0,f=5,g=b("header").outerHeight();b(window).scroll(function(a){d=!0}),setInterval(function(){d&&(a(),d=!1)},250),b("#cl-address").on("click",function(){var a=b(this).attr("data-lat"),c=b(this).attr("data-lng");a&&c&&(location.href="../../pages/map/index.html?longitude="+c+"&latitude="+a)}),b(".swiper-slide").on("click",function(){var a=b(this).find("img").attr("src");c.dom.full.show().append("<a class><img src='"+a+"'></a>")}),c.dom.full.on("click",function(){b(this).html(""),b(this).hide()})},router:function(){var a=this,b=location.href.match(/download\/(.+).html/)[1];switch(b){case"clinic":a.renderClinic();break;case"index":a.fetchNewsContent();break;case"community":a.fetchcommunityContent()}},renderClinic:function(){var a=this;a.fetchClinic()},fetchClinic:function(){var a=this,b={clinicId:Wlib.getRequestParam("clinicId")};Wlib.SendRequestNew("treatQuery","clinicInfo",b,function(b){a.data.clinic=b.value,a.fetchClinicComment()})},fetchClinicComment:function(){var a=this,b={clinicId:Wlib.getRequestParam("clinicId"),firstResult:0,maxResults:5};Wlib.SendRequestNew("treatQuery","findClinicComment",b,function(b){a.data.com=b.value,a.renderUI(),a.recacheDom(),a.bindEvent(),a.dom.loading.hide(),b.value&&0!=b.value.length||Wlib.tips("\u6ca1\u6709\u67e5\u8be2\u5230\u76f8\u5173\u8bb0\u5f55\u3002")})},fetchNewsContent:function(){var a=this,b={newsid:Wlib.getRequestParam("newsid")};Wlib.SendRequestNew("newsQuery","newsInfo",b,function(b){a.data.news=b.value,a.fetchNewsCom(),b.value&&0!=b.value.length||Wlib.tips("\u6ca1\u6709\u67e5\u8be2\u5230\u76f8\u5173\u8bb0\u5f55\u3002")})},fetchNewsCom:function(){var a=this,b={newsid:Wlib.getRequestParam("newsid"),firstResult:0,maxResults:2};Wlib.SendRequestNew("newsQuery","findNewsComments",b,function(b){a.data.com=b.value,a.renderUI(),a.recacheDom(),a.bindEvent(),Wlib._bindLazyLoad(),a.dom.loading.hide(),b.value&&0!=b.value.length||Wlib.tips("\u6ca1\u6709\u67e5\u8be2\u5230\u76f8\u5173\u8bb0\u5f55\u3002")})},fetchcommunityContent:function(){var a=this,b={mainPostId:Wlib.getRequestParam("mainPostId")};Wlib.SendRequestNew("communityQuery","findMainPostById",b,function(b){a.data.com=b.value,a.fetchcommunityReply(),b.value&&0!=b.value.length||Wlib.tips("\u6ca1\u6709\u67e5\u8be2\u5230\u76f8\u5173\u8bb0\u5f55\u3002")})},fetchcommunityReply:function(){var a=this,b={mainPostId:Wlib.getRequestParam("mainPostId"),firstResult:0,maxResults:2};Wlib.SendRequestNew("communityQuery","findPosts",b,function(b){a.data.comList=b.value,a.renderUI(),a.recacheDom(),a.bindEvent();new Swiper("#pics",{slidesPerView:3,paginationClickable:!0,spaceBetween:10}),new Swiper(".reply",{slidesPerView:5,paginationClickable:!0,spaceBetween:10});a.dom.loading.hide(),!b.value||0==b.value.length})}};new c}(window,$);