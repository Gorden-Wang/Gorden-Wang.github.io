/*! Generated by Clam: wechat 2015-11-03 19:02:31 */
!function(a,b,c){var d=function(){this.init()};d.prototype={init:function(){var a=this;a.addJuicerHandler(),a.cacheData(),a.cacheDom(),a.fetchData()},cacheDom:function(){var a=this;a.dom={wrapper:b("#page"),loading:b("#loading"),tpl:b("#tpl")}},cacheData:function(){var a=this;a.data={},a.data.clinicId=Wlib.getRequestParam("clinicId"),a.data.firstResult=0,a.data.maxResults=15},renderUI:function(){var a=this;a.dom.wrapper.html(juicer(a.dom.tpl.html(),a.data)),a.dom.loading.hide()},renderRate:function(){var a=new c({rate:3,wrapper:".rate-wrapper",activeImg:"../../images/redstar.png",defaultImg:"../../images/graystar.png",halfImg:"../../images/halfstar.png"});a.init();var b=new c({rate:3,wrapper:".top-li div",activeImg:"../../images/redstar.png",defaultImg:"../../images/graystar.png"});b.init()},fetchData:function(){var a=this,b={clinicId:a.data.clinicId,firstResult:a.data.firstResult,maxResults:a.data.maxResults};Wlib.SendRequestNew("treatQuery","findClinicComment",b,function(b){a.data.list=b.value,a.data.COUNT=b.value.comments?b.value.comments.length:b.value.length,console.log(a.data),a.renderUI(),a.recacheDom(),b.value.comments&&b.value.comments.length==a.data.maxResults&&a.bindNext(!0)})},bindNext:function(a){var c=this;Wlib._bindScrollTobottom(function(){c.data.firstResult=c.data.firstResult+c.data.maxResults;var a={doctorId:c.data.doctorId,firstResult:c.data.firstResult,maxResults:c.data.maxResults};Wlib.SendRequestNew("treatQuery","findClinicComment",a,function(a){var d={};d.res=a.value||[];var e=juicer(b("#tplItem").html(),d);b("ul").append(e),a.value.comments&&a.value.comments.length==c.data.maxResults&&c.bindNext(!0),a.entity&&0!=a.entity.length||Wlib.tips("\u6ca1\u6709\u67e5\u8be2\u5230\u76f8\u5173\u8bb0\u5f55\u3002")})},a)},addJuicerHandler:function(){juicer.register("makeRate",function(a){a=a||3.4;var b=new c({rate:parseFloat(a),activeImg:"../../images/redstar.png",defaultImg:"../../images/graystar.png",halfImg:"../../images/halfstar.png"});return b.init()}),juicer.register("makeTime",function(a){var b=new Date(a),c={y:b.getFullYear(),m:b.getMonth()+1<10?"0"+(b.getMonth()+1):b.getMonth()+1,d:b.getDate()};return c.y+"/"+c.m+"/"+c.d}),juicer.register("makePercen",function(a){return 100*a})},recacheDom:function(){var a=this;a.dom.banner=b(".banner")},bindEvent:function(){var a=this;a.dom.banner.on("click",function(){var a=b(this).attr("data-href");a&&(window.location=a)})}};new d}(window,$,Rate);